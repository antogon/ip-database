<% url = IpDatabase::Application.routes.url_helpers %>
$(document).ready(function(){
	$('#ip-index-table').dataTable({
			"bServerSide": true,
			"sAjaxSource": "<%= url.url_for :controller => 'ip_addresses', :action => 'dataTable', :only_path => true %>",
			"fnServerData": function ( sSource, aoData, fnCallback, oSettings ) {
	      oSettings.jqXHR = $.ajax( {
				 dataType: 'json',
         type: "POST", 
 	   		 headers: { 'X-CSRF-Token': $('meta[name="csrf-token"]').attr('content') },
 	       url: sSource,
 	       data: aoData,
 	       success: fnCallback
 	      } );
 	    },
			"aoColumnDefs": [
				{ "bSearchable": false, "aTargets": [ 4,5,7 ] },
				{ "sWidth": "15%", "aTargets": [ 0,1,2,3,4,5,6,7 ] },
				{
					"mRender": function ( data, type, full ) {
					        return '<a href="/ip_addresses/'+data+'">Show</a><br/>'+
											'<a href="/ip_addresses/'+data+'/edit">Edit</a><br/>'+
											'<a rel="nofollow" data-method="delete" data-confirm="Are you sure?" href="/ip_addresses/'+data+'">Destroy</a>';
									      },
					"aTargets": [7]
				},
				{
					"mRender": function ( data, type, full ) {
									if(data==="None")
									{
										return data;
									}
									else
									{
					        	return '<a href="/networks/'+data[0]+'">'+data[1]+'</a>';
									}
				},
					"aTargets": [3]
				}
			],
			"fnDrawCallback": function( oSettings ) {
				$('.paginate_disabled_previous').addClass("btn disabled");
				$('.paginate_disabled_next').addClass("btn disabled");
				$('.paginate_enabled_previous').addClass("btn");
				$('.paginate_enabled_next').addClass("btn");
				$('.paginate_enabled_previous').removeClass("disabled");
				$('.paginate_enabled_next').removeClass("disabled");
			}
		});

	var ajax_auto_options, ajax_auto_a;
jQuery(function(){
   ajax_auto_options = { 
		serviceUrl:'<%= url.url_for(:controller => "dns_device_assocs", :action => "autocomplete",:format => :json, :only_path => true) %>',
			delimiter: /(,|;)\s*/, 
			onSelect: function(value,data){
				$('<option value="'+data+'" selected="selected">'+value+'</option>').appendTo($('select[id^=ip_address_dns_devices_attributes_]'));
				//$('select[id^=ip_address_dns_devices_attributes_] > option[value='+data+']').attr('selected', 'selected');
		 }
	};
   ajax_auto_a = $('#dns-assocs-nested-search').autocomplete(ajax_auto_options);
});	

jQuery(function(){
	$(".btn").click(function(){
		var ip_address = #("input#network[network_no]").val();
		if(ip_address == "")
			return false;
		else
			$.ajax({
				type: "POST",
				url: "",
				data: ip_address,
				success: function(data) {
					$(".network_network_parent").children("select:first").children("option").remove();
					for(i = 0; i < data.length; i++){
						$(".network_network_parent").children("select:first")
				});
	});
});

});

